<!-- HTML header for doxygen 1.8.11-->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.11"/>
<title>Fungus: LuaScript</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
  $(window).load(resizeHeight);
</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { init_search(); });
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea" style="background-color: #B7CEEC;">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><a href="https://fungusgames.com" target="_blank"><img alt="Logo" src="logo_small.png"/></a></td>
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname"><!--Fungus-->
   &#160;<span id="projectnumber"><!--v3.3.0--></span>
   </div>
   <div id="projectbrief">v3.3.0 Documentation</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.11 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li class="current"><a href="pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="namespaces.html"><span>Packages</span></a></li>
      <li><a href="annotated.html"><span>Classes</span></a></li>
      <li><a href="files.html"><span>Files</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('lua_script.html','');});
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="headertitle">
<div class="title">LuaScript </div>  </div>
</div><!--header-->
<div class="contents">
<div class="toc"><h3>Table of Contents</h3>
<ul><li class="level1"><a href="#execute_handler">ExecuteHandler component</a></li>
<li class="level1"><a href="#lua_script_files">Lua script and files</a></li>
<li class="level1"><a href="#lua_require">Lua modules and require()</a></li>
<li class="level1"><a href="#error_messages">Error messages</a></li>
<li class="level1"><a href="#setting_lua_environment">Setting the LuaEnvironment</a></li>
<li class="level1"><a href="#runascoroutine_option">RunAsCoroutine option</a></li>
</ul>
</div>
<div class="textblock"><p>The LuaScript component provides an easy way to run Lua scripts in your scene. You can create a LuaScript object via (Tools &gt; Fungus &gt; Create &gt; LuaScript).</p>
<div class="image">
<img src="lua_script.png" alt="lua_script.png"/>
<div class="caption">
LuaScript</div></div>
 <h1><a class="anchor" id="execute_handler"></a>
ExecuteHandler component</h1>
<p>When you create a LuaScript object, you'll see that it contains a component called 'ExecuteHandler'. This component allows you to specify options for when the Lua script should execute. By default it executes the Lua script when the scene starts, but you can change this to execute after a delay, on every update, on trigger events, etc.</p>
<p>If you want to execute a LuaScript from a custom C# script, set On Event to 'Nothing' and instead call the LuaScript.OnExecute() method directly. You can also call the OnExecute() method from a UI event, e.g. a UI Button 'On Click' event.</p>
<h1><a class="anchor" id="lua_script_files"></a>
Lua script and files</h1>
<p>You can enter the Lua code you wish to execute directly into the 'Lua Script' text box. You can also put Lua code into a text file in your project and use the Lua File property to execute it.</p>
<p>You can also use both options at the same time. In this case, the Lua File contents are loaded first and the Lua Script text is appended to that. This is a handy feature for code reuse and configuration, e.g. create a Lua text file with Lua functions to control your game, and then call those functions from the Lua Script text box.</p>
<h1><a class="anchor" id="lua_require"></a>
Lua modules and require()</h1>
<p>The Lua module system allows you to create reusable packages of Lua code and include these in your Lua scripts. <a href="http://www.tutorialspoint.com/lua/lua_modules.htm">This tutorial</a> explains how to write Lua modules. Module files in FungusLua need to be put into a special folder structure so that the Lua require() function is able to locate them.</p>
<p>To use a Lua module:</p>
<ol type="1">
<li>Create a Resources/Lua folder in your project. The capitalization here is important. The folder can be created inside an existing folder in your project.</li>
<li>Create a mymodule.txt file inside the Resources/Lua folder and add your Lua script to it. (Rename mymodule.txt to whatever you want).</li>
<li>You can now use the Lua require function to load the module for use in any Lua script, for example</li>
</ol>
<div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;local mymodule = require(&quot;mymodule&quot;)</div><div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;</div><div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;-- Call a function in the module</div><div class="line"><a name="l00004"></a><span class="lineno">    4</span>&#160;mymodule.myfunction()</div></div><!-- fragment --><h1><a class="anchor" id="error_messages"></a>
Error messages</h1>
<p>When a script contains errors there are a few techniques you can use to track down the source.</p>
<p>FungusLua compiles Lua code at scene startup so that it can be quickly executed when needed later on. This means you will usually see Lua syntax error messages in the console at startup (during compilation), and runtime errors when the script executes later on.</p>
<p>All Lua script errors generate an error message in the Unity log, displayed in red.</p>
<p>For example, if you try to run this invalid code in a LuaScript object: </p><div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;not valid lua</div></div><!-- fragment --><p>It will generate an error message in the log like this </p><div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;LuaScript.LuaScript:(1,0-3): unexpected symbol near &#39;not&#39;</div><div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;1: not valid lua</div></div><!-- fragment --><ul>
<li>The first 'LuaScript.LuaScript' part gives you information about where the Lua script is running from.</li>
<li>The next part in brackets '(1,0-3)' tells you the line number and character range where the error is located.</li>
<li>The last part gives you a description of the type of error.</li>
<li>The next line on gives a listing of the Lua source code. Use the linenumber info above to locate the line causing the problem.</li>
</ul>
<p>One of the most common errors is attempting to access a variable that doesn't exist. In this example error message, we've tried to access the field 'name' on a variable v that hasn't been defined yet.</p>
<div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;LuaScript.LuaScript:(1,7-9): attempt to index a nil value</div><div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;1: print(v.name)</div></div><!-- fragment --><p>To resolve this type of error, carefully check that the variable you want to access has been defined, is spelled correctly and is what you think it is. You can use the print() and inspect() functions to display information about the object in the console. For instance, you may have added a binding to a gameobject, but forgot to select the correct component in the binding.</p>
<p>For runtime errors, a useful technique is to add print() calls in your code just before where the error occurs, and run it again. This way you can print out information to the console to help track down the cause of the error.</p>
<p>MoonSharp includes a remote debugger tool which you can use to step through Lua code and inspect variables. See the <a class="el" href="lua_environment.html">LuaEnvironment</a> for more information.</p>
<h1><a class="anchor" id="setting_lua_environment"></a>
Setting the LuaEnvironment</h1>
<p>By default the LuaScript component will use the first LuaEnvironment it finds in the scene to execute, or create one if none exists. If you want to use a specific LuaEnvironment, set it in the Lua Environment property. This is a good way to keep unrelated sets of Lua scripts sandboxed from each other.</p>
<h1><a class="anchor" id="runascoroutine_option"></a>
RunAsCoroutine option</h1>
<p>This option will run the Lua script as a Lua coroutine which is useful for writing asynchronous code via the coroutine.yield() function in Lua. If you don't need to execute your Lua script asynchronously, deselecting this option will avoid the overhead of running as a coroutine. Recommended for advanced users only! </p>
</div></div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="fungus_lua.html">Fungus Lua</a></li>
    <li class="footer">Generated on Wed Oct 12 2016 13:08:35 for Fungus by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.11 </li>
  </ul>
</div>
</body>
</html>
