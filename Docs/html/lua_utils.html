<!-- HTML header for doxygen 1.8.11-->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.11"/>
<title>Fungus: LuaUtils</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
  $(window).load(resizeHeight);
</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { init_search(); });
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea" style="background-color: #B7CEEC;">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><a href="https://fungusgames.com" target="_blank"><img alt="Logo" src="logo_small.png"/></a></td>
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname"><!--Fungus-->
   &#160;<span id="projectnumber"><!--3.2--></span>
   </div>
   <div id="projectbrief">Documentation</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.11 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li class="current"><a href="pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="namespaces.html"><span>Packages</span></a></li>
      <li><a href="annotated.html"><span>Classes</span></a></li>
      <li><a href="files.html"><span>Files</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('lua_utils.html','');});
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="headertitle">
<div class="title">LuaUtils </div>  </div>
</div><!--header-->
<div class="contents">
<div class="toc"><h3>Table of Contents</h3>
<ul><li class="level1"><a href="#lua_utils_example">Example</a></li>
<li class="level1"><a href="#gameobject_functions">GameObject Functions</a></li>
<li class="level1"><a href="#registering_types">Registering C# Types</a></li>
<li class="level1"><a href="#example_json_file">Example JSON Type File</a></li>
<li class="level1"><a href="#register_types_directly">Registering Types Directly</a></li>
<li class="level1"><a href="#lua_utils_other">Other Utilities</a></li>
<li class="level1"><a href="#pod_factory">PODFactory</a></li>
</ul>
</div>
<div class="textblock"><p>LuaUtils is a component that extends the Lua environment with some commonly used functionality.</p>
<p>It can be accessed from Lua scripts via the 'luautils' global variable. This component mostly does a lot of setup work in the background, but it also provides some handy functions for instantiating, finding and destroying gameobjects in the scene.</p>
<h1><a class="anchor" id="lua_utils_example"></a>
Example</h1>
<p>Here's an example of the kind of thing you can do:</p>
<div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;local go = luautils.Find(&quot;MyObject&quot;) -- Find a game object by name</div><div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;luautils.Destroy(go) -- Destroy it</div></div><!-- fragment --><h1><a class="anchor" id="gameobject_functions"></a>
GameObject Functions</h1>
<p>This is the list of GameObject functions provided in luautils.</p>
<div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;-- Find a game object by name and returns it.</div><div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;GameObject Find(string name)</div><div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;</div><div class="line"><a name="l00004"></a><span class="lineno">    4</span>&#160;-- Returns one active GameObject tagged tag. Returns null if no GameObject was found.</div><div class="line"><a name="l00005"></a><span class="lineno">    5</span>&#160;GameObject FindWithTag(string tag)</div><div class="line"><a name="l00006"></a><span class="lineno">    6</span>&#160;</div><div class="line"><a name="l00007"></a><span class="lineno">    7</span>&#160;-- Returns a list of active GameObjects tagged tag. Returns empty array if no GameObject was found.</div><div class="line"><a name="l00008"></a><span class="lineno">    8</span>&#160;GameObject[] FindGameObjectsWithTag(string tag)</div><div class="line"><a name="l00009"></a><span class="lineno">    9</span>&#160;</div><div class="line"><a name="l00010"></a><span class="lineno">   10</span>&#160;-- Create a copy of a GameObject.</div><div class="line"><a name="l00011"></a><span class="lineno">   11</span>&#160;-- Can be used to instantiate prefabs.</div><div class="line"><a name="l00012"></a><span class="lineno">   12</span>&#160;GameObject Instantiate(GameObject go)</div><div class="line"><a name="l00013"></a><span class="lineno">   13</span>&#160;</div><div class="line"><a name="l00014"></a><span class="lineno">   14</span>&#160;-- Destroys an instance of a GameObject.</div><div class="line"><a name="l00015"></a><span class="lineno">   15</span>&#160;Destroy(GameObject go)</div><div class="line"><a name="l00016"></a><span class="lineno">   16</span>&#160;</div><div class="line"><a name="l00017"></a><span class="lineno">   17</span>&#160;-- Spawns an instance of a named prefab resource.</div><div class="line"><a name="l00018"></a><span class="lineno">   18</span>&#160;-- The prefab must exist in a Resources folder in the project.</div><div class="line"><a name="l00019"></a><span class="lineno">   19</span>&#160;GameObject Spawn(string resourceName)</div></div><!-- fragment --><h1><a class="anchor" id="registering_types"></a>
Registering C# Types</h1>
<p>The most important function of the LuaUtils component is registering C# types so that instances of those types can be accessed from Lua scripts.</p>
<p>In order to access the members of a C# type from Lua, the type first has to be registered with MoonSharp. Note that for objects added using the LuaBindings component, the relevant types are registered automatically.</p>
<p>In some cases however, you will need to register a type explicitly. The easiest way to do this is by adding the type's name to the FungusTypes.txt or UnityTypes.txt JSON files referenced by the LuaUtils component. You can also create your own JSON files to register additional types. Note that types that are not contained in the main application DLL will need to use the <a href="https://msdn.microsoft.com/en-us/library/system.type.assemblyqualifiedname(v=vs.110).aspx">namespace qualified type name</a> in the JSON file.</p>
<h1><a class="anchor" id="example_json_file"></a>
Example JSON Type File</h1>
<p>Example of a types JSON file: </p><div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;{</div><div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;    &quot;registerTypes&quot; : [</div><div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;        &quot;Fungus.Block&quot;</div><div class="line"><a name="l00004"></a><span class="lineno">    4</span>&#160;    ],</div><div class="line"><a name="l00005"></a><span class="lineno">    5</span>&#160;    &quot;extensionTypes&quot; : [</div><div class="line"><a name="l00006"></a><span class="lineno">    6</span>&#160;        &quot;Fungus.LuaExtensions&quot;</div><div class="line"><a name="l00007"></a><span class="lineno">    7</span>&#160;    ]</div><div class="line"><a name="l00008"></a><span class="lineno">    8</span>&#160;}</div></div><!-- fragment --><h1><a class="anchor" id="register_types_directly"></a>
Registering Types Directly</h1>
<p>If you need to register types directly from C#, or do a more complex type of registration, you can use the MoonSharp UserData class to do this. See the MoonSharp documentation for a list of supported registration methods. A good place to register C# types is in the Awake method of a custom component.</p>
<h1><a class="anchor" id="lua_utils_other"></a>
Other Utilities</h1>
<p>LuaUtils creates bindings for several useful C# classes and components so that you can access them from Lua script.</p>
<table class="doxtable">
<tr>
<th>Binding name </th><th>Description  </th></tr>
<tr>
<td>time </td><td>The <a href="http://docs.unity3d.com/ScriptReference/Time.html">Unity Time class</a>. e.g. 'time.deltaTime' returns the delta time for this frame </td></tr>
<tr>
<td>playerprefs </td><td>The <a class="el" href="lua_preferences.html">Lua Preferences</a> class. Used for saving data to disk. </td></tr>
<tr>
<td>prefs </td><td>The <a class="el" href="lua_preferences.html">Fungus Prefs</a> class, our own wrapper around PlayerPrefs that adds a slots systems. </td></tr>
<tr>
<td>factory </td><td>The <a class="el" href="lua_utils.html">PODTypeFactory</a> class for creating common plain-old-data types </td></tr>
<tr>
<td>luaenvironment </td><td>The LuaEnvironment component used to execute Lua scripts </td></tr>
<tr>
<td>luautils </td><td>A reference to the LuaUtils component itself </td></tr>
<tr>
<td>test </td><td>Support for <a class="el" href="lua_unity_test_tools.html">Unity Test Tools</a> (if installed) </td></tr>
<tr>
<td>stringtable </td><td>The FungusLua localisation <a class="el" href="lua_string_table.html">String Table</a> </td></tr>
</table>
<h1><a class="anchor" id="pod_factory"></a>
PODFactory</h1>
<p>Due to limitations in C# / Mono, MoonSharp has limited support for working with Plain-Old-Data (struct) types like <a href="http://docs.unity3d.com/ScriptReference/Vector3.html">Vector3</a>, <a href="http://docs.unity3d.com/ScriptReference/Color.html">Color</a>, etc.</p>
<p>The best approach here is to treat POD properties as immutable objects, and never try to modify a POD variable that has been acquired from a C# object. Instead, you should construct a new POD object, populate it with the required values and then pass that object in calls to C# code. The LuaUtils PODFactory class helps do this for common Unity types.</p>
<div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;-- Returns a new Color object</div><div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;local c = luautils.factory.color(1,1,1,1)</div><div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;</div><div class="line"><a name="l00004"></a><span class="lineno">    4</span>&#160;-- Returns a new Vector2 object</div><div class="line"><a name="l00005"></a><span class="lineno">    5</span>&#160;local v2 = luautils.factory.vector2(1, 2)</div><div class="line"><a name="l00006"></a><span class="lineno">    6</span>&#160;</div><div class="line"><a name="l00007"></a><span class="lineno">    7</span>&#160;-- Returns a new Vector3 object</div><div class="line"><a name="l00008"></a><span class="lineno">    8</span>&#160;local v3 = luautils.factory.vector3(1, 2, 3)</div><div class="line"><a name="l00009"></a><span class="lineno">    9</span>&#160;</div><div class="line"><a name="l00010"></a><span class="lineno">   10</span>&#160;-- Returns a new Vector4 object</div><div class="line"><a name="l00011"></a><span class="lineno">   11</span>&#160;local v4 = luautils.factory.vector4(1, 2, 3, 4)</div><div class="line"><a name="l00012"></a><span class="lineno">   12</span>&#160;</div><div class="line"><a name="l00013"></a><span class="lineno">   13</span>&#160;-- Returns a new Quaternion object</div><div class="line"><a name="l00014"></a><span class="lineno">   14</span>&#160;local q = luautils.factory.quaternion(float x, float y, float z) -- Rotation in euler angles</div><div class="line"><a name="l00015"></a><span class="lineno">   15</span>&#160;</div><div class="line"><a name="l00016"></a><span class="lineno">   16</span>&#160;-- Returns a new Rect object</div><div class="line"><a name="l00017"></a><span class="lineno">   17</span>&#160;local r = luautils.factory.rect(float x, float y, float width, float height)</div></div><!-- fragment --> </div></div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="fungus_lua.html">Fungus Lua</a></li>
    <li class="footer">Generated on Wed Sep 28 2016 14:38:58 for Fungus by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.11 </li>
  </ul>
</div>
</body>
</html>
